import { Component, OnInit } from '@angular/core';
import { CommonModule } from '@angular/common';
import { RouterLink, RouterLinkActive } from '@angular/router';
import { SidebarService } from '../../services/sidebar.service';
import { DomSanitizer, SafeHtml } from '@angular/platform-browser';

interface NavItem {
  label: string;
  icon: SafeHtml;
  iconActive: SafeHtml;
  route: string;
}

@Component({
  selector: 'app-sidebar',
  standalone: true,
  imports: [CommonModule, RouterLink, RouterLinkActive],
  templateUrl: './sidebar.component.html',
  styleUrl: './sidebar.component.scss',
})
export class SidebarComponent implements OnInit {
  navItems: NavItem[] = [];

  isSidebarCollapsed = false;
  mobileMenuOpen = false;

  constructor(
    private sidebarService: SidebarService,
    private sanitizer: DomSanitizer
  ) {}

  ngOnInit() {
    this.sidebarService.mobileMenuOpen$.subscribe((state) => {
      this.mobileMenuOpen = state;
    });

    this.navItems = [
      {
        label: 'Dashboard',
        icon: this.sanitizer.bypassSecurityTrustHtml(`
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M14.8253 18.9584H5.17533C2.89199 18.9584 1.04199 17.1 1.04199 14.8167V8.64169C1.04199 7.50833 1.74199 6.08333 2.64199 5.38333L7.13366 1.88333C8.48366 0.833333 10.642 0.783333 12.042 1.76666L17.192 5.375C18.1837 6.06666 18.9587 7.55 18.9587 8.75835V14.825C18.9587 17.1 17.1087 18.9584 14.8253 18.9584ZM7.90032 2.86666L3.40866 6.36666C2.81699 6.83333 2.29199 7.89166 2.29199 8.64169V14.8167C2.29199 16.4084 3.58366 17.7084 5.17533 17.7084H14.8253C16.417 17.7084 17.7087 16.4167 17.7087 14.825V8.75835C17.7087 7.95833 17.1337 6.85 16.4753 6.4L11.3253 2.79166C10.3753 2.125 8.80866 2.15833 7.90032 2.86666Z" fill="#2E4528"/>
                <path d="M10 15.6251C9.65833 15.6251 9.375 15.3417 9.375 15.0001V12.5001C9.375 12.1584 9.65833 11.8751 10 11.8751C10.3417 11.8751 10.625 12.1584 10.625 12.5001V15.0001C10.625 15.3417 10.3417 15.6251 10 15.6251Z" fill="#2E4528"/>
            </svg>`),
        iconActive: this.sanitizer.bypassSecurityTrustHtml(`
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M16.6998 5.68471L11.8998 2.32637C10.5915 1.40971 8.58318 1.45971 7.32487 2.43471L3.14987 5.69304C2.31654 6.34304 1.6582 7.67637 1.6582 8.72633V14.4763C1.6582 16.6013 3.3832 18.3347 5.5082 18.3347H14.4915C16.6165 18.3347 18.3415 16.6097 18.3415 14.4847V8.83466C18.3415 7.70971 17.6165 6.32637 16.6998 5.68471ZM10.6248 15.0013C10.6248 15.343 10.3415 15.6263 9.99985 15.6263C9.65818 15.6263 9.37485 15.343 9.37485 15.0013V12.5013C9.37485 12.1597 9.65818 11.8763 9.99985 11.8763C10.3415 11.8763 10.6248 12.1597 10.6248 12.5013V15.0013Z" fill="#689E5B"/>
            </svg>`),
        route: '/dashboard',
      },

      {
        label: 'Projects',
        icon: this.sanitizer.bypassSecurityTrustHtml(`
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M10 18.3333V10M10 10L2.74167 5.83333M10 10L17.2583 5.83333M6.25 3.55833L13.75 7.85M9.16667 18.1083C9.42003 18.2546 9.70744 18.3316 10 18.3316C10.2926 18.3316 10.58 18.2546 10.8333 18.1083L16.6667 14.775C16.9198 14.6289 17.13 14.4187 17.2763 14.1657C17.4225 13.9127 17.4997 13.6256 17.5 13.3333V6.66667C17.4997 6.3744 17.4225 6.08734 17.2763 5.8343C17.13 5.58126 16.9198 5.37114 16.6667 5.225L10.8333 1.89167C10.58 1.74539 10.2926 1.66838 10 1.66838C9.70744 1.66838 9.42003 1.74539 9.16667 1.89167L3.33333 5.225C3.08022 5.37114 2.86998 5.58126 2.72372 5.8343C2.57745 6.08734 2.5003 6.3744 2.5 6.66667V13.3333C2.5003 13.6256 2.57745 13.9127 2.72372 14.1657C2.86998 14.4187 3.08022 14.6289 3.33333 14.775L9.16667 18.1083Z" stroke="#2E4528" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>`),
        iconActive: this.sanitizer.bypassSecurityTrustHtml(`
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M10 18.3333V9.99996M10 9.99996L2.74167 5.83329M10 9.99996L17.2583 5.83329M6.25 3.55829L13.75 7.84996M9.16667 18.1083C9.42003 18.2546 9.70744 18.3316 10 18.3316C10.2926 18.3316 10.58 18.2546 10.8333 18.1083L16.6667 14.775C16.9198 14.6288 17.13 14.4187 17.2763 14.1657C17.4225 13.9126 17.4997 13.6256 17.5 13.3333V6.66663C17.4997 6.37435 17.4225 6.0873 17.2763 5.83426C17.13 5.58122 16.9198 5.37109 16.6667 5.22496L10.8333 1.89163C10.58 1.74535 10.2926 1.66833 10 1.66833C9.70744 1.66833 9.42003 1.74535 9.16667 1.89163L3.33333 5.22496C3.08022 5.37109 2.86998 5.58122 2.72372 5.83426C2.57745 6.0873 2.5003 6.37435 2.5 6.66663V13.3333C2.5003 13.6256 2.57745 13.9126 2.72372 14.1657C2.86998 14.4187 3.08022 14.6288 3.33333 14.775L9.16667 18.1083Z" stroke="#689E5B" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>`),
        route: '/projects',
      },
      {
        label: 'Services',
        icon: this.sanitizer.bypassSecurityTrustHtml(`
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M13.9703 5.41667C14.428 4.90521 15.0933 4.58333 15.8337 4.58333C17.2144 4.58333 18.3337 5.70262 18.3337 7.08333C18.3337 8.46404 17.2144 9.58333 15.8337 9.58333H10.8337M5.6369 3.33333C6.09467 2.82188 6.75991 2.5 7.50033 2.5C8.88104 2.5 10.0003 3.61929 10.0003 5C10.0003 6.38071 8.88104 7.5 7.50033 7.5H1.66699M8.97024 16.6667C9.428 17.1781 10.0932 17.5 10.8337 17.5C12.2144 17.5 13.3337 16.3807 13.3337 15C13.3337 13.6193 12.2144 12.5 10.8337 12.5H1.66699" stroke="#2E4528" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>`),
        iconActive: this.sanitizer.bypassSecurityTrustHtml(`
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M13.9703 5.41667C14.428 4.90521 15.0933 4.58333 15.8337 4.58333C17.2144 4.58333 18.3337 5.70262 18.3337 7.08333C18.3337 8.46404 17.2144 9.58333 15.8337 9.58333H10.8337M5.6369 3.33333C6.09467 2.82188 6.75991 2.5 7.50033 2.5C8.88104 2.5 10.0003 3.61929 10.0003 5C10.0003 6.38071 8.88104 7.5 7.50033 7.5H1.66699M8.97024 16.6667C9.428 17.1781 10.0932 17.5 10.8337 17.5C12.2144 17.5 13.3337 16.3807 13.3337 15C13.3337 13.6193 12.2144 12.5 10.8337 12.5H1.66699" stroke="#689E5B" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>`),
        route: '/services',
      },
      {
        label: 'Clients',
        icon: this.sanitizer.bypassSecurityTrustHtml(`
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M13.3337 2.8898C14.5684 3.50343 15.417 4.77762 15.417 6.25C15.417 7.72238 14.5684 8.99657 13.3337 9.6102M15.0003 13.972C16.2599 14.5419 17.3941 15.4708 18.3337 16.6667M1.66699 16.6667C3.28907 14.6021 5.49131 13.3333 7.91699 13.3333C10.3427 13.3333 12.5449 14.6021 14.167 16.6667M11.667 6.25C11.667 8.32107 9.98806 10 7.91699 10C5.84592 10 4.16699 8.32107 4.16699 6.25C4.16699 4.17893 5.84592 2.5 7.91699 2.5C9.98806 2.5 11.667 4.17893 11.667 6.25Z" stroke="#2E4528" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>`),
        iconActive: this.sanitizer.bypassSecurityTrustHtml(`
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M13.3337 2.8898C14.5684 3.50343 15.417 4.77762 15.417 6.25C15.417 7.72238 14.5684 8.99657 13.3337 9.6102M15.0003 13.972C16.2599 14.5419 17.3941 15.4708 18.3337 16.6667M1.66699 16.6667C3.28907 14.6021 5.49131 13.3333 7.91699 13.3333C10.3427 13.3333 12.5449 14.6021 14.167 16.6667M11.667 6.25C11.667 8.32107 9.98806 10 7.91699 10C5.84592 10 4.16699 8.32107 4.16699 6.25C4.16699 4.17893 5.84592 2.5 7.91699 2.5C9.98806 2.5 11.667 4.17893 11.667 6.25Z" stroke="#689E5B" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>`),
        route: '/clients',
      },
      {
        label: 'Awards',
        icon: this.sanitizer.bypassSecurityTrustHtml(`
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M6.63923 12.2683L5.83366 18.3333L9.65733 16.0391C9.78204 15.9643 9.84439 15.9269 9.91096 15.9123C9.96983 15.8994 10.0308 15.8994 10.0897 15.9123C10.1563 15.9269 10.2186 15.9643 10.3433 16.0391L14.167 18.3333L13.3622 12.2677M15.8337 7.5C15.8337 10.7217 13.222 13.3333 10.0003 13.3333C6.77866 13.3333 4.16699 10.7217 4.16699 7.5C4.16699 4.27834 6.77866 1.66666 10.0003 1.66666C13.222 1.66666 15.8337 4.27834 15.8337 7.5Z" stroke="#2E4528" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>`),
        iconActive: this.sanitizer.bypassSecurityTrustHtml(`
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M6.63923 12.2682L5.83366 18.3333L9.65733 16.0391C9.78204 15.9643 9.84439 15.9269 9.91096 15.9122C9.96983 15.8993 10.0308 15.8993 10.0897 15.9122C10.1563 15.9269 10.2186 15.9643 10.3433 16.0391L14.167 18.3333L13.3622 12.2677M15.8337 7.49996C15.8337 10.7216 13.222 13.3333 10.0003 13.3333C6.77866 13.3333 4.16699 10.7216 4.16699 7.49996C4.16699 4.2783 6.77866 1.66663 10.0003 1.66663C13.222 1.66663 15.8337 4.2783 15.8337 7.49996Z" stroke="#689E5B" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>`),
        route: '/awards',
      },
      {
        label: 'Testimonials',
        icon: this.sanitizer.bypassSecurityTrustHtml(`
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
                <path d="M7.49985 11.6667C7.49985 11.6667 8.5936 12.9167 10.4165 12.9167C12.2394 12.9167 13.3332 11.6667 13.3332 11.6667M12.7082 7.5H12.7165M8.12485 7.5H8.13318M10.4165 16.6667C14.3285 16.6667 17.4998 13.4953 17.4998 9.58333C17.4998 5.67132 14.3285 2.5 10.4165 2.5C6.5045 2.5 3.33318 5.67132 3.33318 9.58333C3.33318 10.375 3.46306 11.1363 3.70266 11.8472C3.79282 12.1147 3.83791 12.2484 3.84604 12.3512C3.85407 12.4527 3.848 12.5238 3.82289 12.6225C3.79747 12.7223 3.74135 12.8262 3.62909 13.034L2.26605 15.557C2.07162 15.9168 1.97441 16.0968 1.99617 16.2356C2.01512 16.3566 2.08631 16.4631 2.19083 16.5269C2.31083 16.6001 2.51427 16.579 2.92113 16.537L7.18865 16.0958C7.31789 16.0825 7.3825 16.0758 7.4414 16.0781C7.49933 16.0803 7.54022 16.0857 7.59671 16.0987C7.65414 16.112 7.72637 16.1398 7.87081 16.1954C8.66086 16.4998 9.5192 16.6667 10.4165 16.6667ZM13.1249 7.5C13.1249 7.73012 12.9383 7.91667 12.7082 7.91667C12.4781 7.91667 12.2915 7.73012 12.2915 7.5C12.2915 7.26988 12.4781 7.08333 12.7082 7.08333C12.9383 7.08333 13.1249 7.26988 13.1249 7.5ZM8.54152 7.5C8.54152 7.73012 8.35497 7.91667 8.12485 7.91667C7.89473 7.91667 7.70818 7.73012 7.70818 7.5C7.70818 7.26988 7.89473 7.08333 8.12485 7.08333C8.35497 7.08333 8.54152 7.26988 8.54152 7.5Z" stroke="#2E4528" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>`),
        iconActive: this.sanitizer.bypassSecurityTrustHtml(`
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path d="M7.49985 11.6667C7.49985 11.6667 8.5936 12.9167 10.4165 12.9167C12.2394 12.9167 13.3332 11.6667 13.3332 11.6667M12.7082 7.5H12.7165M8.12485 7.5H8.13318M10.4165 16.6667C14.3285 16.6667 17.4998 13.4953 17.4998 9.58333C17.4998 5.67132 14.3285 2.5 10.4165 2.5C6.5045 2.5 3.33318 5.67132 3.33318 9.58333C3.33318 10.375 3.46306 11.1363 3.70266 11.8472C3.79282 12.1147 3.83791 12.2484 3.84604 12.3512C3.85407 12.4527 3.848 12.5238 3.82289 12.6225C3.79747 12.7223 3.74135 12.8262 3.62909 13.034L2.26605 15.557C2.07162 15.9168 1.97441 16.0968 1.99617 16.2356C2.01512 16.3566 2.08631 16.4631 2.19083 16.5269C2.31083 16.6001 2.51427 16.579 2.92113 16.537L7.18865 16.0958C7.31789 16.0825 7.3825 16.0758 7.4414 16.0781C7.49933 16.0803 7.54022 16.0857 7.59671 16.0987C7.65414 16.112 7.72637 16.1398 7.87081 16.1954C8.66086 16.4998 9.5192 16.6667 10.4165 16.6667ZM13.1249 7.5C13.1249 7.73012 12.9383 7.91667 12.7082 7.91667C12.4781 7.91667 12.2915 7.73012 12.2915 7.5C12.2915 7.26988 12.4781 7.08333 12.7082 7.08333C12.9383 7.08333 13.1249 7.26988 13.1249 7.5ZM8.54152 7.5C8.54152 7.73012 8.35497 7.91667 8.12485 7.91667C7.89473 7.91667 7.70818 7.73012 7.70818 7.5C7.70818 7.26988 7.89473 7.08333 8.12485 7.08333C8.35497 7.08333 8.54152 7.26988 8.54152 7.5Z" stroke="#689E5B" stroke-width="1.66667" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>`),
        route: '/testimonials',
      },
    ];
  }

  toggleSidebar() {
    this.isSidebarCollapsed = !this.isSidebarCollapsed;
    this.sidebarService.toggleSidebarCollapse(this.isSidebarCollapsed);
  }

  getCollapseTitle(): string {
    return this.isSidebarCollapsed ? 'Show Menu' : 'Hide Menu';
  }

  onNavItemClick() {
    // Close mobile menu when navigation item is clicked
    this.sidebarService.closeMobileMenu();
  }

  closeMobileMenu() {
    this.sidebarService.closeMobileMenu();
  }
}

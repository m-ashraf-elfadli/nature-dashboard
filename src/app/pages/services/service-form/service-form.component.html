<div class="page-container">
  <div class="form-header">
    <app-page-header [title]="pageTitle"></app-page-header>
    <app-form-actions
      (discard)="onDiscard()"
      (save)="onSave()"
      (languageChange)="onLanguageChange($event)"
    ></app-form-actions>
  </div>
  <form
    [formGroup]="serviceForm"
    (ngSubmit)="submitForm()"
    class="service-form"
  >
    <div class="fieldsets-container">
      <div class="fieldset">
        <legend>Service Details</legend>
        <div class="our-field">
          <label for="serviceName"
            >Service Name
            <span class="required">*</span>
          </label>
          <input
            type="text"
            id="serviceName"
            placeholder="Enter service Name...."
            formControlName="serviceName"
            pInputText
          />
        </div>

        <div class="our-field">
          <label for="serviceTagline"
            >Service Tagline
            <span class="required">*</span>
          </label>
          <input
            type="text"
            id="serviceTagline"
            placeholder="Enter Service Tagline...."
            formControlName="serviceTagline"
            pInputText
          />
        </div>
      </div>
      <app-settings formControlName="status"></app-settings>
    </div>
    <div class="fieldset">
      <legend>
        Service Stages
        <span>(Maximum 3 allowed)</span>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          viewBox="0 0 16 16"
          fill="none"
        >
          <path
            d="M8.66666 13.9999H14M10 3.33326L12.6667 5.99993M14.116 4.54126C14.4685 4.18888 14.6665 3.71091 14.6666 3.2125C14.6666 2.71409 14.4687 2.23607 14.1163 1.8836C13.7639 1.53112 13.286 1.33307 12.7876 1.33301C12.2892 1.33295 11.8111 1.53088 11.4587 1.88326L2.56133 10.7826C2.40654 10.9369 2.29207 11.127 2.228 11.3359L1.34733 14.2373C1.3301 14.2949 1.3288 14.3562 1.34356 14.4145C1.35833 14.4728 1.38861 14.5261 1.43119 14.5686C1.47378 14.6111 1.52708 14.6413 1.58544 14.656C1.64379 14.6707 1.70504 14.6693 1.76266 14.6519L4.66466 13.7719C4.87344 13.7084 5.06345 13.5947 5.218 13.4406L14.116 4.54126Z"
            stroke="#6C6C6C"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
      </legend>
      @if(stages.length > 0) {
      <app-mini-table
        [data]="stages"
        [columns]="cols"
        [reorderable]="true"
        [showImage]="true"
        imageField="imagePreview"
        (rowDeleted)="onDeleteStage($event)"
        (reordered)="onReorder($event)"
        style="width: 100%"
      >
      </app-mini-table>
      <button
        class="add-another"
        type="button"
        (click)="openStagePopup()"
        *ngIf="stages.length < 3"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="18"
          height="18"
          viewBox="0 0 18 18"
          fill="none"
        >
          <path
            d="M8.75217 0.79541V16.7084M16.7087 8.75192L0.795654 8.75192"
            stroke="#75B267"
            stroke-width="1.5913"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
        <span>Add Another</span>
      </button>
      } @else {
      <app-empty-state-action
        title="Start Adding stages to appear here"
        subtitle="Start adding the first service stage."
        buttonLabel="Add New Stage"
        (action)="openStagePopup()"
        style="width: 100%"
      ></app-empty-state-action>
      }
    </div>

    <div class="fieldsets-container">
      <div class="fieldset"></div>
      <div class="fieldset"></div>
    </div>
  </form>
</div>
